<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
  </head>
  <style>
    .hidden {
      display: none;
    }
  </style>
  <body>
    <ul id="message-list"></ul>
    <button class="hidden" id="close-socket">Close connection</button>

    <script>
      const messageList = document.getElementById("message-list");
      const closeSocketBtn = document.getElementById("close-socket");

      const socket = new WebSocket("ws://localhost:5000");
      const closeSocket = () => {
        socket.close(1000, "Frontend close connection");
      };

      socket.addEventListener("open", () => {
        messageList.insertAdjacentHTML(
          "beforeend",
          "<li>Successfully connected</li>"
        );
        closeSocketBtn.classList.remove("hidden");
        closeSocketBtn.addEventListener("click", closeSocket);
      });

      socket.addEventListener("message", (event) => {
        messageList.insertAdjacentHTML("beforeend", `<li>${event.data}</li>`);
      });

      socket.addEventListener("close", (event) => {
        if (event.wasClean) {
          messageList.insertAdjacentHTML(
            "beforeend",
            `<li>${event.reason}</li>`
          );
        } else {
          messageList.insertAdjacentHTML(
            "beforeend",
            "<li>Server crushed</li>"
          );
        }
        closeSocketBtn.classList.add("hidden");
        closeSocketBtn.removeEventListener("click", closeSocket);
      });
    </script>
  </body>
</html>
